/* datalayer-helper (2024-04-28T17:22:33.662Z). Copyright 2024 Toni Arndt. This work is licensed under the terms of the MIT license. For a copy, see <https://github.com/toniarndt/datalayer-helper/blob/main/LICENSE>. */
"use strict";var d=(()=>{var u=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var k=Object.prototype.hasOwnProperty;var C=(e,t)=>{for(var r in t)u(e,r,{get:t[r],enumerable:!0})},$=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of D(t))!k.call(e,a)&&a!==r&&u(e,a,{get:()=>t[a],enumerable:!(n=h(t,a))||n.enumerable});return e};var j=e=>$(u({},"__esModule",{value:!0}),e);var M={};C(M,{builddate:()=>R,clearDatalayer:()=>E,cloneDatalayer:()=>F,combine:()=>S,decodeBase64:()=>y,deleteCookie:()=>U,encodeBase64:()=>b,flattenDatalayer:()=>V,fromString:()=>q,getCookie:()=>P,getCookies:()=>p,getDatalayer:()=>A,getQueryParameter:()=>I,getQueryParameters:()=>Q,getValue:()=>L,log:()=>o,setCookie:()=>T,setDebug:()=>w,setValue:()=>_,toString:()=>B,useDatalayer:()=>J});var R="2024-04-28T17:22:33.662Z";function f(e){if(e===null||typeof e!="object")return e;if(Array.isArray(e))return e.map(n=>f(n));let t={};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=f(e[r]));return t}function d(e,t=""){let r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null?Object.assign(r,d(e[n],t+n+"_")):r[t+n]=e[n]}),r}function b(e){return btoa(unescape(encodeURIComponent(e)))}function y(e){return decodeURIComponent(escape(atob(e)))}var c=!1;function w(e){c!=e&&(c=e,c==!0?o({message:"The debug mode has been activated",functionName:"setDebug",level:"log"}):o({message:"The debug mode has been deactivated",functionName:"setDebug",level:"log"}))}var O="\u26A1 datalayer-helper";function o(e){if(c==!0){let t=console[e.level],r=`${O} @${e.functionName}`;e.message!=null&&(r+=`: ${e.message}`),t.apply(console,e.args==null?[r]:[r,e.args])}}function _(e,t){let r=window._datalayer,n=e.split(".");for(let a=0;a<n.length;a++){let l=n[a];a<n.length-1?(r[l]={},r=r[l]):(r[l]=t,o({message:`'${e}' = '${t}'`,functionName:"setValue",level:"log"}))}}function L(e){let t=window._datalayer,r=e.split(".");for(let n=0;n<r.length;n++){let a=r[n];if(Object.hasOwn(t,a)==!1)break;if(typeof t[a]=="object")t=t[a];else return o({message:`'${e}' = '${t[a]}'`,functionName:"getValue",level:"log"}),t[a]}return o({message:`Namespace '${e}' is undefined`,functionName:"getValue",level:"warn"}),null}function S(e,t,r=",",n=":"){let a=[];for(let l=0;l<e.length;l++)for(let i=0;i<t.length;i++){let m=e[l].trim().replaceAll(n,"\u203A"),g=t[i].trim().replaceAll(n,"\u203A");a.push(`${m}${n}${g}`)}return o({message:null,functionName:"combination",level:"log",args:a.join(r)}),a.join(r)}function T(e,t,r=1800,n="/"){let a=new Date;a.setTime(a.getTime()+r*1e3);let l="expires="+a.toUTCString();document.cookie=`${e}=${t};${l};path=${n}`,o({message:`Cookie: '${e}' = '${t}' | Expires: ${r}s | Path: ${n}`,functionName:"setCookie",level:"log"})}function p(){let e=Object.assign({},...decodeURI(document.cookie).split(";").map(t=>{let[r,n]=t.split("=");return r.trimStart()==""?null:{[r.trimStart()]:n}}));return Object.keys(e).length==0?o({message:"No cookies are set",functionName:"getCookies",level:"log"}):o({message:null,functionName:"getCookies",level:"log",args:e}),e}function P(e){let t=p();return t!=null&&e in t?(o({message:`'${e}' = '${t[e]}'`,functionName:"getCookie",level:"log"}),t[e]):(o({message:`Cookie '${e}' not found`,functionName:"getCookie",level:"warn"}),null)}function U(e){let t=new Date;t.setTime(t.getTime());let r="expires="+t.toUTCString();document.cookie=`${e}=;${r};path=/`,o({message:`Cookie '${e}' deleted`,functionName:"deleteCookie",level:"log"})}function I(e,t="string",r=document.URL){if(t!="string"&&t!="array")return o({message:`Invalid type "${t}" was passed (string | array)`,functionName:"getQueryParameter",level:"error"}),null;let n=[];if(r.indexOf("?")!=-1){let a=r.split("?");if(a.length>=1){let l=a[1].split("&");for(let i=0;i<l.length;i++){let[m,g]=l[i].split("="),v=decodeURIComponent(m);if(e!=v)continue;let N=typeof g>"u"?"":decodeURIComponent(g);n.push(N)}}}if(n.length==0)return o({message:`No query parameters passed for the key "${e}"`,functionName:"getQueryParameter",level:"warn"}),null;switch(t){case"string":return o({message:`"${e}" (first-value)`,functionName:"getQueryParameter",level:"log",args:n[0]}),n[0];case"array":return o({message:`"${e}" (all-values)`,functionName:"getQueryParameter",level:"log",args:n}),n;default:return null}}function Q(e=document.URL){let t=[];if(e.indexOf("?")!=-1){let r=e.split("?");if(r.length>=1){let n=r[1].split("&");for(let a=0;a<n.length;a++){let[l,i]=n[a].split("="),m=decodeURIComponent(l),g=typeof i>"u"?"":decodeURIComponent(i);t.push([m,g])}}}return t.length==0?o({message:"No query parameters passed",functionName:"getQueryParameters",level:"warn"}):o({message:null,functionName:"getQueryParameters",level:"log",args:t}),t}function A(){return o({functionName:"getDatalayer",message:"Returns the datalayer as an object",level:"log"}),window._datalayer}function E(){for(let e of Object.getOwnPropertyNames(window._datalayer))delete window._datalayer[e];o({functionName:"clearDatalayer",message:"Datalayer object cleared",level:"log"})}function F(e){let t=f(e);return o({functionName:"cloneDatalayer",message:"Cloned datalayer object was returned",level:"log"}),t}function V(e){let t=d(e);return o({functionName:"flattenDatalayer",message:"Flattened datalayer object was returned",level:"log"}),t}function q(e){try{window._datalayer=JSON.parse(e),o({functionName:"fromString",message:"Datalayer created from string",level:"log"})}catch{o({functionName:"fromString",message:"Datalayer object could not be created from the string",level:"error"})}}function B(){return o({functionName:"toString",message:"Returns the datalayer as a string",level:"log"}),JSON.stringify(window._datalayer)}function J(e){e==null?(window._datalayer={},o({functionName:"useDatalayer",message:"Standard global datalayer object has been reset and is now used",level:"log"})):typeof e=="object"?(window._datalayer=e,o({functionName:"useDatalayer",message:"Custom global datalayer object is now used",level:"log"})):o({functionName:"useDatalayer",message:"Custom datalayer object cannot be used because no object was transferred",level:"error"})}window._datalayer||(window._datalayer={});return j(M);})();
